knitr::opts_chunk$set(echo = FALSE)
dataGenreYear
dataGenreYear <- dataGenre %>%
group_by(Year, Genre) %>%
summarise(Count = n(), MeanRev = mean(Revenue, na.rm = TRUE))
#Import library yang diperlukan
library(ggplot2)
library(dplyr)
library(tidyr)
#Import dataset yang digunakan
data <- read.csv("IMDB-Movie-Data.csv")
head(data)
i <- 1
while (i <= nrow(data)) {
genres <- unlist(strsplit(data$Genre[i], ",", fixed = TRUE))
data$Genre1[i] <- genres[1]
data$Genre2[i] <- genres[2]
data$Genre3[i] <- genres[3]
i <- i + 1
}
head(data)
dataGenre1 <- data.frame(data$Title, data$Year, data$Genre1, data$Revenue..Millions.)
colnames(dataGenre1) <- c("Title", "Year", "Genre", "Revenue")
dataGenre2 <- data.frame(data$Title, data$Year, data$Genre2, data$Revenue..Millions.)
colnames(dataGenre2) <- c("Title", "Year", "Genre", "Revenue")
dataGenre2 <- dataGenre2 %>% drop_na(Genre)
dataGenre3 <- data.frame(data$Title, data$Year, data$Genre3, data$Revenue..Millions.)
colnames(dataGenre3) <- c("Title", "Year", "Genre", "Revenue")
dataGenre3 <- dataGenre3 %>% drop_na(Genre)
dataGenre <- bind_rows(dataGenre1, dataGenre2, dataGenre3)
dataGenre
dataGenreYear <- dataGenre %>%
group_by(Year, Genre) %>%
summarise(Count = n(), MeanRev = mean(Revenue, na.rm = TRUE))
#Untuk kolom bernilai NaN akan diubah nilainya menjadi 0
dataGenreYear$MeanRev[is.nan(dataGenreYear$MeanRev)] <- 0
dataGenreYear
dataGenreTotal <- dataGenreYear %>%
group_by(Genre) %>%
summarise(Count = sum(Count), MeanRev = mean(MeanRev))
ggplot(dataGenreTotal, aes(x = reorder(Genre, Count), y = Count))+
geom_bar(stat = 'identity')+
coord_flip()+
xlab("Genre")+
ylab("Count")+
ggtitle("Jumlah Seluruh Film Bedasarkan Genre")
ggplot(dataGenreTotal, aes(x = reorder(Genre, MeanRev), y = MeanRev))+
geom_bar(stat = 'identity')+
coord_flip()+
xlab("Genre")+
ylab("Revenue in Million Dollar")+
ggtitle("Rata-rata Revenue Film Bedasarkan Genre")
